{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.errorCodeToString = errorCodeToString;\nexports.processErrorResponse = processErrorResponse;\nexports.getVersion = getVersion;\nexports.ERROR_CODE = exports.P1_VALUES = exports.PAYLOAD_TYPE = exports.INS = exports.APP_KEY = exports.CHUNK_SIZE = exports.CLA = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar CLA = 0x55;\nexports.CLA = CLA;\nvar CHUNK_SIZE = 250;\nexports.CHUNK_SIZE = CHUNK_SIZE;\nvar APP_KEY = \"CSM\";\nexports.APP_KEY = APP_KEY;\nvar INS = {\n  GET_VERSION: 0x00,\n  INS_PUBLIC_KEY_SECP256K1: 0x01,\n  // Obsolete\n  SIGN_SECP256K1: 0x02,\n  GET_ADDR_SECP256K1: 0x04\n};\nexports.INS = INS;\nvar PAYLOAD_TYPE = {\n  INIT: 0x00,\n  ADD: 0x01,\n  LAST: 0x02\n};\nexports.PAYLOAD_TYPE = PAYLOAD_TYPE;\nvar P1_VALUES = {\n  ONLY_RETRIEVE: 0x00,\n  SHOW_ADDRESS_IN_DEVICE: 0x01\n};\nexports.P1_VALUES = P1_VALUES;\nvar ERROR_CODE = {\n  NoError: 0x9000\n};\nexports.ERROR_CODE = ERROR_CODE;\nvar ERROR_DESCRIPTION = {\n  1: \"U2F: Unknown\",\n  2: \"U2F: Bad request\",\n  3: \"U2F: Configuration unsupported\",\n  4: \"U2F: Device Ineligible\",\n  5: \"U2F: Timeout\",\n  14: \"Timeout\",\n  0x9000: \"No errors\",\n  0x9001: \"Device is busy\",\n  0x6802: \"Error deriving keys\",\n  0x6400: \"Execution Error\",\n  0x6700: \"Wrong Length\",\n  0x6982: \"Empty Buffer\",\n  0x6983: \"Output buffer too small\",\n  0x6984: \"Data is invalid\",\n  0x6985: \"Conditions not satisfied\",\n  0x6986: \"Transaction rejected\",\n  0x6a80: \"Bad key handle\",\n  0x6b00: \"Invalid P1/P2\",\n  0x6d00: \"Instruction not supported\",\n  0x6e00: \"App does not seem to be open\",\n  0x6f00: \"Unknown error\",\n  0x6f01: \"Sign/verify error\"\n};\n\nfunction errorCodeToString(statusCode) {\n  if (statusCode in ERROR_DESCRIPTION) return ERROR_DESCRIPTION[statusCode];\n  return \"Unknown Status Code: \".concat(statusCode);\n}\n\nfunction isDict(v) {\n  return (0, _typeof2.default)(v) === \"object\" && v !== null && !(v instanceof Array) && !(v instanceof Date);\n}\n\nfunction processErrorResponse(response) {\n  if (response) {\n    if (isDict(response)) {\n      if (Object.prototype.hasOwnProperty.call(response, \"statusCode\")) {\n        return {\n          return_code: response.statusCode,\n          error_message: errorCodeToString(response.statusCode)\n        };\n      }\n\n      if (Object.prototype.hasOwnProperty.call(response, \"return_code\") && Object.prototype.hasOwnProperty.call(response, \"error_message\")) {\n        return response;\n      }\n    }\n\n    return {\n      return_code: 0xffff,\n      error_message: response.toString()\n    };\n  }\n\n  return {\n    return_code: 0xffff,\n    error_message: response.toString()\n  };\n}\n\nfunction getVersion(_x) {\n  return _getVersion.apply(this, arguments);\n}\n\nfunction _getVersion() {\n  _getVersion = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(transport) {\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", transport.send(CLA, INS.GET_VERSION, 0, 0).then(function (response) {\n              var errorCodeData = response.slice(-2);\n              var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n              var targetId = 0;\n\n              if (response.length >= 9) {\n                /* eslint-disable no-bitwise */\n                targetId = (response[5] << 24) + (response[6] << 16) + (response[7] << 8) + (response[8] << 0);\n                /* eslint-enable no-bitwise */\n              }\n\n              return {\n                return_code: returnCode,\n                error_message: errorCodeToString(returnCode),\n                // ///\n                test_mode: response[0] !== 0,\n                major: response[1],\n                minor: response[2],\n                patch: response[3],\n                device_locked: response[4] === 1,\n                target_id: targetId.toString(16)\n              };\n            }, processErrorResponse));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getVersion.apply(this, arguments);\n}","map":{"version":3,"sources":["/Users/makand/cosmwasm/dApps/node_modules/ledger-cosmos-js/dist/common.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","errorCodeToString","processErrorResponse","getVersion","ERROR_CODE","P1_VALUES","PAYLOAD_TYPE","INS","APP_KEY","CHUNK_SIZE","CLA","_regenerator","_asyncToGenerator2","_typeof2","GET_VERSION","INS_PUBLIC_KEY_SECP256K1","SIGN_SECP256K1","GET_ADDR_SECP256K1","INIT","ADD","LAST","ONLY_RETRIEVE","SHOW_ADDRESS_IN_DEVICE","NoError","ERROR_DESCRIPTION","statusCode","concat","isDict","v","default","Array","Date","response","prototype","hasOwnProperty","call","return_code","error_message","toString","_x","_getVersion","apply","arguments","mark","_callee","transport","wrap","_callee$","_context","prev","next","abrupt","send","then","errorCodeData","slice","returnCode","targetId","length","test_mode","major","minor","patch","device_locked","target_id","stop"],"mappings":"AAAA;;AAEA,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAAD,CAApC;;AAEAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,iBAAR,GAA4BA,iBAA5B;AACAF,OAAO,CAACG,oBAAR,GAA+BA,oBAA/B;AACAH,OAAO,CAACI,UAAR,GAAqBA,UAArB;AACAJ,OAAO,CAACK,UAAR,GAAqBL,OAAO,CAACM,SAAR,GAAoBN,OAAO,CAACO,YAAR,GAAuBP,OAAO,CAACQ,GAAR,GAAcR,OAAO,CAACS,OAAR,GAAkBT,OAAO,CAACU,UAAR,GAAqBV,OAAO,CAACW,GAAR,GAAc,KAAK,CAAxI;;AAEA,IAAIC,YAAY,GAAGhB,sBAAsB,CAACC,OAAO,CAAC,4BAAD,CAAR,CAAzC;;AAEA,IAAIgB,kBAAkB,GAAGjB,sBAAsB,CAACC,OAAO,CAAC,yCAAD,CAAR,CAA/C;;AAEA,IAAIiB,QAAQ,GAAGlB,sBAAsB,CAACC,OAAO,CAAC,+BAAD,CAAR,CAArC;;AAEA,IAAIc,GAAG,GAAG,IAAV;AACAX,OAAO,CAACW,GAAR,GAAcA,GAAd;AACA,IAAID,UAAU,GAAG,GAAjB;AACAV,OAAO,CAACU,UAAR,GAAqBA,UAArB;AACA,IAAID,OAAO,GAAG,KAAd;AACAT,OAAO,CAACS,OAAR,GAAkBA,OAAlB;AACA,IAAID,GAAG,GAAG;AACRO,EAAAA,WAAW,EAAE,IADL;AAERC,EAAAA,wBAAwB,EAAE,IAFlB;AAGR;AACAC,EAAAA,cAAc,EAAE,IAJR;AAKRC,EAAAA,kBAAkB,EAAE;AALZ,CAAV;AAOAlB,OAAO,CAACQ,GAAR,GAAcA,GAAd;AACA,IAAID,YAAY,GAAG;AACjBY,EAAAA,IAAI,EAAE,IADW;AAEjBC,EAAAA,GAAG,EAAE,IAFY;AAGjBC,EAAAA,IAAI,EAAE;AAHW,CAAnB;AAKArB,OAAO,CAACO,YAAR,GAAuBA,YAAvB;AACA,IAAID,SAAS,GAAG;AACdgB,EAAAA,aAAa,EAAE,IADD;AAEdC,EAAAA,sBAAsB,EAAE;AAFV,CAAhB;AAIAvB,OAAO,CAACM,SAAR,GAAoBA,SAApB;AACA,IAAID,UAAU,GAAG;AACfmB,EAAAA,OAAO,EAAE;AADM,CAAjB;AAGAxB,OAAO,CAACK,UAAR,GAAqBA,UAArB;AACA,IAAIoB,iBAAiB,GAAG;AACtB,KAAG,cADmB;AAEtB,KAAG,kBAFmB;AAGtB,KAAG,gCAHmB;AAItB,KAAG,wBAJmB;AAKtB,KAAG,cALmB;AAMtB,MAAI,SANkB;AAOtB,UAAQ,WAPc;AAQtB,UAAQ,gBARc;AAStB,UAAQ,qBATc;AAUtB,UAAQ,iBAVc;AAWtB,UAAQ,cAXc;AAYtB,UAAQ,cAZc;AAatB,UAAQ,yBAbc;AActB,UAAQ,iBAdc;AAetB,UAAQ,0BAfc;AAgBtB,UAAQ,sBAhBc;AAiBtB,UAAQ,gBAjBc;AAkBtB,UAAQ,eAlBc;AAmBtB,UAAQ,2BAnBc;AAoBtB,UAAQ,8BApBc;AAqBtB,UAAQ,eArBc;AAsBtB,UAAQ;AAtBc,CAAxB;;AAyBA,SAASvB,iBAAT,CAA2BwB,UAA3B,EAAuC;AACrC,MAAIA,UAAU,IAAID,iBAAlB,EAAqC,OAAOA,iBAAiB,CAACC,UAAD,CAAxB;AACrC,SAAO,wBAAwBC,MAAxB,CAA+BD,UAA/B,CAAP;AACD;;AAED,SAASE,MAAT,CAAgBC,CAAhB,EAAmB;AACjB,SAAO,CAAC,GAAGf,QAAQ,CAACgB,OAAb,EAAsBD,CAAtB,MAA6B,QAA7B,IAAyCA,CAAC,KAAK,IAA/C,IAAuD,EAAEA,CAAC,YAAYE,KAAf,CAAvD,IAAgF,EAAEF,CAAC,YAAYG,IAAf,CAAvF;AACD;;AAED,SAAS7B,oBAAT,CAA8B8B,QAA9B,EAAwC;AACtC,MAAIA,QAAJ,EAAc;AACZ,QAAIL,MAAM,CAACK,QAAD,CAAV,EAAsB;AACpB,UAAInC,MAAM,CAACoC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCH,QAArC,EAA+C,YAA/C,CAAJ,EAAkE;AAChE,eAAO;AACLI,UAAAA,WAAW,EAAEJ,QAAQ,CAACP,UADjB;AAELY,UAAAA,aAAa,EAAEpC,iBAAiB,CAAC+B,QAAQ,CAACP,UAAV;AAF3B,SAAP;AAID;;AAED,UAAI5B,MAAM,CAACoC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCH,QAArC,EAA+C,aAA/C,KAAiEnC,MAAM,CAACoC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCH,QAArC,EAA+C,eAA/C,CAArE,EAAsI;AACpI,eAAOA,QAAP;AACD;AACF;;AAED,WAAO;AACLI,MAAAA,WAAW,EAAE,MADR;AAELC,MAAAA,aAAa,EAAEL,QAAQ,CAACM,QAAT;AAFV,KAAP;AAID;;AAED,SAAO;AACLF,IAAAA,WAAW,EAAE,MADR;AAELC,IAAAA,aAAa,EAAEL,QAAQ,CAACM,QAAT;AAFV,GAAP;AAID;;AAED,SAASnC,UAAT,CAAoBoC,EAApB,EAAwB;AACtB,SAAOC,WAAW,CAACC,KAAZ,CAAkB,IAAlB,EAAwBC,SAAxB,CAAP;AACD;;AAED,SAASF,WAAT,GAAuB;AACrBA,EAAAA,WAAW,GAAG,CAAC,GAAG5B,kBAAkB,CAACiB,OAAvB,GAAiC,aAAalB,YAAY,CAACkB,OAAb,CAAqBc,IAArB,CAA0B,SAASC,OAAT,CAAiBC,SAAjB,EAA4B;AAChH,WAAOlC,YAAY,CAACkB,OAAb,CAAqBiB,IAArB,CAA0B,SAASC,QAAT,CAAkBC,QAAlB,EAA4B;AAC3D,aAAO,CAAP,EAAU;AACR,gBAAQA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACE,IAAjC;AACE,eAAK,CAAL;AACE,mBAAOF,QAAQ,CAACG,MAAT,CAAgB,QAAhB,EAA0BN,SAAS,CAACO,IAAV,CAAe1C,GAAf,EAAoBH,GAAG,CAACO,WAAxB,EAAqC,CAArC,EAAwC,CAAxC,EAA2CuC,IAA3C,CAAgD,UAAUrB,QAAV,EAAoB;AACnG,kBAAIsB,aAAa,GAAGtB,QAAQ,CAACuB,KAAT,CAAe,CAAC,CAAhB,CAApB;AACA,kBAAIC,UAAU,GAAGF,aAAa,CAAC,CAAD,CAAb,GAAmB,GAAnB,GAAyBA,aAAa,CAAC,CAAD,CAAvD;AACA,kBAAIG,QAAQ,GAAG,CAAf;;AAEA,kBAAIzB,QAAQ,CAAC0B,MAAT,IAAmB,CAAvB,EAA0B;AACxB;AACAD,gBAAAA,QAAQ,GAAG,CAACzB,QAAQ,CAAC,CAAD,CAAR,IAAe,EAAhB,KAAuBA,QAAQ,CAAC,CAAD,CAAR,IAAe,EAAtC,KAA6CA,QAAQ,CAAC,CAAD,CAAR,IAAe,CAA5D,KAAkEA,QAAQ,CAAC,CAAD,CAAR,IAAe,CAAjF,CAAX;AACA;AACD;;AAED,qBAAO;AACLI,gBAAAA,WAAW,EAAEoB,UADR;AAELnB,gBAAAA,aAAa,EAAEpC,iBAAiB,CAACuD,UAAD,CAF3B;AAGL;AACAG,gBAAAA,SAAS,EAAE3B,QAAQ,CAAC,CAAD,CAAR,KAAgB,CAJtB;AAKL4B,gBAAAA,KAAK,EAAE5B,QAAQ,CAAC,CAAD,CALV;AAML6B,gBAAAA,KAAK,EAAE7B,QAAQ,CAAC,CAAD,CANV;AAOL8B,gBAAAA,KAAK,EAAE9B,QAAQ,CAAC,CAAD,CAPV;AAQL+B,gBAAAA,aAAa,EAAE/B,QAAQ,CAAC,CAAD,CAAR,KAAgB,CAR1B;AASLgC,gBAAAA,SAAS,EAAEP,QAAQ,CAACnB,QAAT,CAAkB,EAAlB;AATN,eAAP;AAWD,aAtBgC,EAsB9BpC,oBAtB8B,CAA1B,CAAP;;AAwBF,eAAK,CAAL;AACA,eAAK,KAAL;AACE,mBAAO8C,QAAQ,CAACiB,IAAT,EAAP;AA5BJ;AA8BD;AACF,KAjCM,EAiCJrB,OAjCI,CAAP;AAkCD,GAnC2D,CAA9C,CAAd;AAoCA,SAAOJ,WAAW,CAACC,KAAZ,CAAkB,IAAlB,EAAwBC,SAAxB,CAAP;AACD","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.errorCodeToString = errorCodeToString;\nexports.processErrorResponse = processErrorResponse;\nexports.getVersion = getVersion;\nexports.ERROR_CODE = exports.P1_VALUES = exports.PAYLOAD_TYPE = exports.INS = exports.APP_KEY = exports.CHUNK_SIZE = exports.CLA = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar CLA = 0x55;\nexports.CLA = CLA;\nvar CHUNK_SIZE = 250;\nexports.CHUNK_SIZE = CHUNK_SIZE;\nvar APP_KEY = \"CSM\";\nexports.APP_KEY = APP_KEY;\nvar INS = {\n  GET_VERSION: 0x00,\n  INS_PUBLIC_KEY_SECP256K1: 0x01,\n  // Obsolete\n  SIGN_SECP256K1: 0x02,\n  GET_ADDR_SECP256K1: 0x04\n};\nexports.INS = INS;\nvar PAYLOAD_TYPE = {\n  INIT: 0x00,\n  ADD: 0x01,\n  LAST: 0x02\n};\nexports.PAYLOAD_TYPE = PAYLOAD_TYPE;\nvar P1_VALUES = {\n  ONLY_RETRIEVE: 0x00,\n  SHOW_ADDRESS_IN_DEVICE: 0x01\n};\nexports.P1_VALUES = P1_VALUES;\nvar ERROR_CODE = {\n  NoError: 0x9000\n};\nexports.ERROR_CODE = ERROR_CODE;\nvar ERROR_DESCRIPTION = {\n  1: \"U2F: Unknown\",\n  2: \"U2F: Bad request\",\n  3: \"U2F: Configuration unsupported\",\n  4: \"U2F: Device Ineligible\",\n  5: \"U2F: Timeout\",\n  14: \"Timeout\",\n  0x9000: \"No errors\",\n  0x9001: \"Device is busy\",\n  0x6802: \"Error deriving keys\",\n  0x6400: \"Execution Error\",\n  0x6700: \"Wrong Length\",\n  0x6982: \"Empty Buffer\",\n  0x6983: \"Output buffer too small\",\n  0x6984: \"Data is invalid\",\n  0x6985: \"Conditions not satisfied\",\n  0x6986: \"Transaction rejected\",\n  0x6a80: \"Bad key handle\",\n  0x6b00: \"Invalid P1/P2\",\n  0x6d00: \"Instruction not supported\",\n  0x6e00: \"App does not seem to be open\",\n  0x6f00: \"Unknown error\",\n  0x6f01: \"Sign/verify error\"\n};\n\nfunction errorCodeToString(statusCode) {\n  if (statusCode in ERROR_DESCRIPTION) return ERROR_DESCRIPTION[statusCode];\n  return \"Unknown Status Code: \".concat(statusCode);\n}\n\nfunction isDict(v) {\n  return (0, _typeof2.default)(v) === \"object\" && v !== null && !(v instanceof Array) && !(v instanceof Date);\n}\n\nfunction processErrorResponse(response) {\n  if (response) {\n    if (isDict(response)) {\n      if (Object.prototype.hasOwnProperty.call(response, \"statusCode\")) {\n        return {\n          return_code: response.statusCode,\n          error_message: errorCodeToString(response.statusCode)\n        };\n      }\n\n      if (Object.prototype.hasOwnProperty.call(response, \"return_code\") && Object.prototype.hasOwnProperty.call(response, \"error_message\")) {\n        return response;\n      }\n    }\n\n    return {\n      return_code: 0xffff,\n      error_message: response.toString()\n    };\n  }\n\n  return {\n    return_code: 0xffff,\n    error_message: response.toString()\n  };\n}\n\nfunction getVersion(_x) {\n  return _getVersion.apply(this, arguments);\n}\n\nfunction _getVersion() {\n  _getVersion = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(transport) {\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", transport.send(CLA, INS.GET_VERSION, 0, 0).then(function (response) {\n              var errorCodeData = response.slice(-2);\n              var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n              var targetId = 0;\n\n              if (response.length >= 9) {\n                /* eslint-disable no-bitwise */\n                targetId = (response[5] << 24) + (response[6] << 16) + (response[7] << 8) + (response[8] << 0);\n                /* eslint-enable no-bitwise */\n              }\n\n              return {\n                return_code: returnCode,\n                error_message: errorCodeToString(returnCode),\n                // ///\n                test_mode: response[0] !== 0,\n                major: response[1],\n                minor: response[2],\n                patch: response[3],\n                device_locked: response[4] === 1,\n                target_id: targetId.toString(16)\n              };\n            }, processErrorResponse));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getVersion.apply(this, arguments);\n}"]},"metadata":{},"sourceType":"script"}